<!DOCTYPE html><html lang=en><head><meta charset=utf-8><meta http-equiv=content-type content="text/html; charset=utf-8"><meta http-equiv=X-UA-Compatible content="IE=edge,chrome=1"><title>express-coffee-react-views | A Place for Poor Examples</title><meta name=description content="Express View Engine for Rendering JSX Components written in CoffeeScript"><meta name=keywords content="JavaScript, HTML, software, development, blog, examples, derby, cracking, coding, interview, CoffeeScript, node, express, .NET, C#, ASP.NET, Ember, Knockout, Angular, algorithms, analysis, analytics"><meta name=author content="Matt Blair"><meta name=google-site-verification content=pLaNxAD_C5VD6yWlQnX9ScKil_pSvI3lXz-9k4nOyYU><meta name=generator content="DocPad v6.79.4"><meta name=viewport content="width=device-width"><link rel="shortcut icon" href=/images/icons/favicon.ico><link rel=apple-touch-icon-precomposed sizes=144x144 href=/images/icons/apple-touch-icon-144-precomposed.png><link rel=apple-touch-icon-precomposed sizes=114x114 href=/images/icons/apple-touch-icon-114-precomposed.png><link rel=apple-touch-icon-precomposed sizes=72x72 href=/images/icons/apple-touch-icon-72-precomposed.png><link rel=apple-touch-icon-precomposed href=/images/icons/apple-touch-icon-57-precomposed.png><link rel=stylesheet href=/styles/twitter-bootstrap.css><link rel=stylesheet href=/styles/style.css><link rel=stylesheet href=/styles/mono-blue.css><link href=/atom.xml type=application/atom+xml rel=alternate title=Posts></head><body><div class="navbar navbar-inverse navbar-fixed-top"><div class=container><div class=navbar-header><button type=button class=navbar-toggle data-toggle=collapse data-target=.navbar-collapse><span class=icon-bar></span> <span class=icon-bar></span> <span class=icon-bar></span></button> <a class=navbar-brand href="/">A Place for Poor Examples</a></div><div class="navbar-collapse collapse"><ul class="nav navbar-nav"><li typeof=sioc:Page about=/pages/about.html><a href=/pages/about.html property=dc:title>About</a></li><li typeof=sioc:Page about=/pages/posts.html><a href=/pages/posts.html property=dc:title>Posts</a></li><li typeof=sioc:Page about=/pages/hockey-stuff.html><a href=/pages/hockey-stuff.html property=dc:title>Hobbies</a></li></ul></div></div></div><div class=container><section id=content class=content><div class=row><div class=col-lg-9><article id=express-coffee-react-views class=post><div class=post-content><h1 class=post-title>express-coffee-react-views</h1><div class=post-date>Wed Oct 08 2014</div><p>This is an <a href="http://expressjs.com/">Express</a> view engine which renders <a href="http://facebook.github.io/react/">React</a> components written in <a href="http://coffeescript.org/">CoffeeScript</a> on the server. It renders static markup and <em>does not</em> support mounting those views on the client.</p><p>This was derived from <a href=https://github.com/reactjs/express-react-views>express-react-views</a></p><p>This is intended to be used as a replacement for existing server-side view solutions, like <a href="http://jade-lang.com/">jade</a>, <a href="http://embeddedjs.com/">ejs</a>, or <a href=https://github.com/barc/express-hbs>handlebars</a>.</p><h2 id=usage>Usage</h2><pre class=highlight><code class="hljs bash">npm install express-coffee-react-views react
</code></pre><p><strong>Note:</strong> You must explicitly install <code>react</code> as a dependency. <code>react</code> is a peer dependency here. This is to avoid issues that may come when using incompatible versions.</p><h3 id=add-it-to-your-app->Add it to your app.</h3><pre class=highlight><code class="hljs coffeescript"><span class=hljs-comment># app.coffee</span>

app = express()

app.set <span class=hljs-string>'view engine'</span>, <span class=hljs-string>'cjsx'</span>
app.engine <span class=hljs-string>'cjsx'</span>, <span class=hljs-built_in>require</span>(<span class=hljs-string>'express-coffee-react-views'</span>).createEngine()
</code></pre><h3 id=options>Options</h3><p>You can pass options in when creating your engine.</p><table><thead><tr><th>option</th><th>values</th><th>default</th></tr></thead><tbody><tr><td><code>extension</code></td><td>any file extension with leading <code>.</code></td><td><code>&quot;.cjsx&quot;</code></td></tr><tr><td><code>doctype</code></td><td>any string that can be used as <a href=http://en.wikipedia.org/wiki/Document_type_declaration>a doctype</a>, this will be prepended to your document</td><td><code>&quot;&lt;!DOCTYPE html&gt;&quot;</code></td></tr><tr><td><code>beautify</code></td><td><code>true</code>: beautify markup before outputting (note, this can affect rendering due to additional whitespace)</td><td><code>false</code></td></tr></tbody></table><p>The defaults are sane, but just in case you want to change something, here&#39;s how it would look:</p><pre class=highlight><code class="hljs coffeescript">options =  extension: <span class=hljs-string>'.csx'</span>
app.engine <span class=hljs-string>'cjsx'</span>, <span class=hljs-built_in>require</span>(<span class=hljs-string>'express-coffee-react-views'</span>).createEngine options
</code></pre><h3 id=views>Views</h3><p>Your views should be node modules that export a React component. Let&#39;s assume you have this file in <code>views/index.cjsx</code>:</p><pre class=highlight><code class="hljs undefined">/** @cjsx React.DOM */

HelloMessage = React.createClass
  render: -&gt;
    &lt;div&gt;Hello {this.props.name}&lt;/div&gt;

module.exports = HelloMessage
</code></pre><h3 id=routes>Routes</h3><p>Your routes would look identical to the default routes Express gives you out of the box.</p><pre class=highlight><code class="hljs coffeescript"><span class=hljs-comment># app.coffee</span>

app.get <span class=hljs-string>'/'</span>, <span class=hljs-built_in>require</span>(<span class=hljs-string>'./routes'</span>).index
</code></pre><pre class=highlight><code class="hljs coffeescript"><span class=hljs-comment># routes/index.coffee</span>

exports.index = <span class=hljs-function><span class=hljs-params>(req, res)</span> -&gt;</span>
  res.render <span class=hljs-string>'index'</span>, { name: <span class=hljs-string>'John'</span> }
</code></pre><p><strong>That&#39;s it!</strong> Layouts follow really naturally from the idea of composition.</p><h3 id=layouts>Layouts</h3><p>Simply pass the relevant props to a layout component.</p><p><code>views/layouts/default.cjsx</code>:</p><pre class=highlight><code class="hljs undefined">/** @cjsx React.DOM */

DefaultLayout = React.createClass
  render: -&gt;
    &lt;html&gt;
      &lt;head&gt;&lt;title&gt;{this.props.title}&lt;/title&gt;&lt;/head&gt;
      &lt;body&gt;{this.props.children}&lt;/body&gt;
    &lt;/html&gt;

module.exports = DefaultLayout
</code></pre><p><code>views/index.cjsx</code>:</p><pre class=highlight><code class="hljs undefined">/** @cjsx React.DOM */

DefaultLayout = require './layouts/default'

HelloMessage = React.createClass
  render: -&gt;
    &lt;DefaultLayout title={this.props.title}&gt;
      &lt;div&gt;Hello {this.props.name}&lt;/div&gt;
    &lt;/DefaultLayout&gt;

module.exports = HelloMessage
</code></pre><h2 id=questions>Questions</h2><h3 id=what-about-partials-includes->What about partials &amp; includes?</h3><p>These ideas don&#39;t really apply. But since they are familiar ideas to people coming from more traditional &quot;templating&quot; solutions, let&#39;s address it. Most of these can be solved by packaging up another component that encapsulates that piece of functionality.</p><h3 id=what-about-view-helpers->What about view helpers?</h3><p>I know you&#39;re used to registering helpers with your view helper (<code>hbs.registerHelper(&#39;something&#39;, ...))</code>) and operating on strings. But you don&#39;t need to do that here.</p><ul><li>Many helpers can be turned into components. Then you can just require and use them in your view.</li><li>You have access to everything else in CoffeeScript. If you want to do some date formatting, you can <code>require(&#39;moment&#39;)</code> and use directly in your view. You can bundle up other helpers as you please.</li></ul><h3 id=where-does-my-data-come-from->Where does my data come from?</h3><p>All &quot;locals&quot; are exposed to your view in <code>this.props</code>. These should work identically to other view engines.</p><p>Using <code>this.props</code> follows the pattern of passing data into a React component, which is why we do it that way.</p><p>Remember, as with other engines, rendering is synchronous. If you have database access or other async operations, they should be done in your routes.</p><h2 id=caveats>Caveats</h2><ul><li>I&#39;m saying it again to avoid confusion: this does not do anything with React in the browser. This is <em>only</em> a solution for server-side rendering.</li><li>This uses <code>require</code> to access your views. This means that the plugin caches the contents for the lifetime of the server process. You need to restart your server when making changes to your views. <strong>In development, we clear your view files from the cache so you can refresh your browser to see changes.</strong></li><li>React &amp; JSX have their own rendering caveats. For example, inline <code>&lt;script&gt;</code>s and <code>&lt;style&gt;</code>s will need to use <code>dangerouslySetInnerHTML={{__html: &#39;script content&#39;}}</code>.</li></ul><pre class=highlight><code class="hljs coffeescript">&lt;script dangerouslySetInnerHTML={{__html: <span class=hljs-string>"""
  # google analtyics
  # is a common use
"""</span>}} /&gt;
</code></pre><ul><li>It&#39;s not possible to specify a doctype in JSX. You can override the default HTML5 doctype in the options.</li></ul></div></article><footer><div id=disqus_thread></div><script type=text/javascript>
        var disqus_shortname = 'codetype';
        var disqus_identifier = 'express-coffee-react-views';
        var disqus_title = 'express-coffee-react-views';

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script><noscript>Please enable JavaScript to view the <a href=http://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript></footer></div><div class="col-lg-3 hidden-xs hidden-sm"><nav class=link-list><h3>Recent Posts</h3><div class=recent-post><a class=title href=/posts/20180115-manager-conference-links.html>Manager Conference Links</a></div><div class=recent-post><a class=title href=/posts/20181121-elasticsearch-perf-work.html>ElasticSearch Perf - Highlighter Edition</a></div><div class=recent-post><a class=title href=/posts/20180908-moment-js-alternatives.html>Moment.js alternatives</a></div><div class=recent-post><a class=title href=/posts/20180601-manager-readme.html>Manager READMEs</a></div><div class=recent-post><a class=title href=/posts/20180305-elasticsearch-sharding-work.html>ElasticSearch sharding work</a></div><div class=recent-post><a class=title href=/posts/20171229-engineering-management-classes.html>Engineering Management Classes</a></div></nav></div></div></section></div><script defer src=//cdnjs.cloudflare.com/ajax/libs/jquery/1.10.2/jquery.min.js></script><script defer src=//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js></script><script defer src=/vendor/twitter-bootstrap/dist/js/bootstrap.min.js></script><script defer src=/scripts/script.js></script><script defer src=/scripts/analytics.js></script></body></html>